(Grammar
  (Program       (#name (* TopLevel)))
  (TopLevel      (| StrTable Struct Def Decl))
  (StrTable      (str-table (* StrTableEntry)))
  (StrTableEntry (#int String))
  (Struct        (struct Name (* Field)))
  (Field         (#name Type))
  (Def           (def Name Params Type Do))
  (Decl          (decl Name Types Type))
  (Stmt          (| Let Return If Store Auto Do Call))
  (If            (if Value Stmt))
  (Store         (store Value Value))
  (Auto          (auto Name Type))
  (Do            (do (* Stmt)))
  (Return        (| ReturnExpr ReturnVoid))
  (ReturnExpr    (return Value))
  (ReturnVoid    (return-void))
  (Let           (let Name Expr))
  (Value         (| StrGet Literal Name))
  (StrGet        (str-get IntLiteral))
  (Literal       (| BoolLiteral IntLiteral))
  (IntLiteral    (| UntypedIntLiteral TypedIntLiteral))
  (UntypedIntLiteral  (#int))
  (TypedIntLiteral    (#type UntypedIntLiteral))
  (BoolLiteral   (#bool))
  (String        (#string))
  (Name          (#name))
  (Types         (types (* Type)))
  (Type          (#type))
  (Params        (params (* Param)))
  (Param         (#name Type))
  (Expr          (| Call MathBinop Icmp Load Index Cast Value))
  (MathBinop     (| Add))
  (Icmp          (| LT LE GT GE EQ NE))
  (LT            ($binopI <))
  (LE            ($binopI <=))
  (GT            ($binopI >))
  (GE            ($binopI >=))
  (EQ            ($binopI ==))
  (NE            ($binopI !=))
  (Load          (load Value))
  (Index         (index Value Value))
  (Cast          (| BitCast PtrToInt IntToPtr))
  (BitCast       (bitcast Type Value))
  (IntToPtr      (inttoptr Type Value))
  (PtrToInt      (ptrtoint Type Value))
  (Add           ($binopI +))
  (Call          (| CallBasic CallVargs CallTail))
  (CallBasic     (call Name Args))
  (CallVargs     (call-vargs Name Args))
  (CallTail      (call-tail Name Args))
  (Args          (args (* Value)))
)